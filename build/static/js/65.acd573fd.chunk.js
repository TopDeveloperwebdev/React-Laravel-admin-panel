(this.webpackJsonphulk=this.webpackJsonphulk||[]).push([[65],{2555:function(e,t,a){"use strict";a.r(t);var n=a(15),i=a(16),r=a(421),l=a(18),s=a(17),o=a(0),c=a.n(o),p=(a(1589),a(237)),m=a(85),u=a.n(m),d=a(124),g=a(28),f=a(2256),h=a(2342),y=a.n(h);y.a.setLanguage("de"),y.a.setRegion("de"),y.a.setApiKey("AIzaSyDMrIaIY6QY_kiOz0VSZkN36HBd4cnfkH8"),y.a.enableDebug();var v=[{featureType:"poi.medical",stylers:[{visibility:"off"}]},{featureType:"poi.school",stylers:[{visibility:"off"}]},{featureType:"poi.sports_complex",stylers:[{visibility:"off"}]},{featureType:"road.arterial",stylers:[{visibility:"off"}]},{featureType:"transit.station.airport",stylers:[{visibility:"off"}]},{featureType:"transit.station.rail",stylers:[{visibility:"off"}]}],b={icon:"http://maps.google.com/mapfiles/ms/icons/pink-dot.png",scaledSize:100},E={icon:"http://maps.google.com/mapfiles/ms/icons/blue-dot.png",scaledSize:100},k=function(e){Object(l.a)(a,e);var t=Object(s.a)(a);function a(e){var i;return Object(n.a)(this,a),(i=t.call(this,e)).getCity=function(e){for(var t=0;t<e.length;t++)if(e[t].types[0]&&"administrative_area_level_2"===e[t].types[0])return e[t].long_name},i.getArea=function(e){for(var t=0;t<e.length;t++)if(e[t].types[0])for(var a=0;a<e[t].types.length;a++)if("sublocality_level_1"===e[t].types[a]||"locality"===e[t].types[a])return e[t].long_name},i.getState=function(e){for(var t=0;t<e.length;t++)for(var a=0;a<e.length;a++)if(e[a].types[0]&&"administrative_area_level_1"===e[a].types[0])return e[a].long_name},i.onChange=function(e){i.setState(Object(g.a)({},e.target.name,e.target.value))},i.onInfoWindowClose=function(e){},i.onMarkerDragEnd=function(e){var t=e.latLng.lat(),a=e.latLng.lng();y.a.fromLatLng(t,a).then((function(e){var n=e.results[0].formatted_address,r=e.results[0].address_components,l=r.length?i.getCity(r):"",s=r.length?i.getArea(r):"",o=r.length?i.getState(r):"";i.setState({address:n||"",area:s||"",city:l||"",state:o||"",markerPosition:{lat:t,lng:a},mapPosition:{lat:t,lng:a}})}),(function(e){console.error(e)}))},i.state={address:"",city:"",area:"",test:"",mapPosition:{lat:i.props.center.lat,lng:i.props.center.lng},markerPosition:{lat:i.props.center.lat,lng:i.props.center.lng},patientAddress:[],selectedPatient:""},i.InitializePatient=i.InitializePatient.bind(Object(r.a)(i)),i}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.InitializePatient(this.props.patients)}},{key:"InitializePatient",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=this,n=[],t.map(function(){var e=Object(d.a)(u.a.mark((function e(i,r){var l,s,o,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i.streetNr){e.next=6;break}return e.next=3,y.a.fromAddress(i.streetNr);case 3:l=e.sent,s=l.results[0].geometry.location,o=s.lat,c=s.lng,o&&c&&(n.push({id:i.id,lat:o,lng:c}),t.length-2<r&&a.setState({patientAddress:n}));case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state.patientAddress;console.log("props",this.props.selectedPatient);var a=Object(f.withScriptjs)(Object(f.withGoogleMap)((function(a){return c.a.createElement(f.GoogleMap,{defaultZoom:e.props.zoom,defaultCenter:{lat:e.state.mapPosition.lat,lng:e.state.mapPosition.lng},defaultOptions:{styles:v}},t.length>0&&t.map((function(t,a){return console.log("patient.streetNr == this.props.selectedPatient ",e.props.selectedPatient),c.a.createElement(f.Marker,{options:t.id==e.props.selectedPatient?b:E,key:a,name:"Dolores park",draggable:!0,onDragEnd:e.onMarkerDragEnd,position:{lat:t.lat,lng:t.lng}})})))})));return c.a.createElement("div",null,c.a.createElement(a,{googleMapURL:"https://maps.googleapis.com/maps/api/js?key=AIzaSyDMrIaIY6QY_kiOz0VSZkN36HBd4cnfkH8&libraries=places",loadingElement:c.a.createElement("div",{style:{height:"100%"}}),containerElement:c.a.createElement("div",{style:{height:this.props.height}}),mapElement:c.a.createElement("div",{style:{height:"100%"}})}))}}]),a}(c.a.Component),P=a(11),O=a(2343),S=a.n(O),_=a(1527),j=a(1528),C=a(61),w=a(115),z=a(229),N=a(1529),I=a(1533),x=a(2346),A=a.n(x),D=a(2345),M=a.n(D),R=a(224),T=function(e){Object(l.a)(a,e);var t=Object(s.a)(a);function a(e){var i;return Object(n.a)(this,a),(i=t.call(this,e)).handleClick=function(e){var t=!i.state.open;i.setState({open:t}),e.streetNr&&i.props.OnRowclick(e.id)},i.state={open:!1},i}return Object(i.a)(a,[{key:"render",value:function(){var e=this,t=this.props.row;return c.a.createElement(c.a.Fragment,null,c.a.createElement(I.a,null,c.a.createElement(N.a,{align:"left"},t.firstName+" "+t.lastName),c.a.createElement(N.a,{align:"left"},t.phone1),c.a.createElement(N.a,{align:"right"},c.a.createElement(z.a,{"aria-label":"expand row",size:"small",onClick:function(){return e.handleClick(t)}},this.state.open?c.a.createElement(M.a,null):c.a.createElement(A.a,null)))),this.state.open?c.a.createElement(I.a,null,c.a.createElement(N.a,{style:{paddingBottom:0,paddingTop:0},colSpan:6},c.a.createElement(R.a,{in:this.state.open,timeout:"auto",unmountOnExit:!0},c.a.createElement(C.a,{margin:1},c.a.createElement(w.a,{gutterBottom:!0,component:"div"},t.streetNr),c.a.createElement(w.a,{gutterBottom:!0,component:"div"},t.zipCode),c.a.createElement(w.a,{gutterBottom:!0,component:"div"},t.city))))):"")}}]),a}(c.a.Component),B=function(e){Object(l.a)(a,e);var t=Object(s.a)(a);function a(e){var i;return Object(n.a)(this,a),(i=t.call(this,e)).onPlaceSelected=function(e){console.log("plc",e);var t=e.formatted_address,a=e.address_components,n=i.mapPage.current.getCity(a),r=i.mapPage.current.getArea(a),l=i.mapPage.current.getState(a),s=e.geometry.location.lat(),o=e.geometry.location.lng();i.mapPage.current.setState({address:t||"",area:r||"",city:n||"",state:l||"",markerPosition:{lat:s,lng:o},mapPosition:{lat:s,lng:o}})},i.handleClick=function(e){i.setState({selectedPatient:e})},i.state={data:[],openData:{},patients:[],selectedPatient:""},i.mapPage=c.a.createRef(),i.Row=c.a.createRef(),i.handleClick=i.handleClick.bind(Object(r.a)(i)),i}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=JSON.parse(localStorage.getItem("user"));this.instance_id=t.instance_id,console.log("res",this.instance_id),p.a.getPatients({instance_id:this.instance_id,pagination:1}).then((function(t){var a=t;e.setState({data:a})}))}},{key:"render",value:function(){var e=this,t=this.state,a=t.data,n=t.selectedPatient;return c.a.createElement("div",{className:"mapContainer"},c.a.createElement("div",{className:"patientsContainer"},c.a.createElement(P.c,null,c.a.createElement(S.a,{style:{width:"100%",height:"40px",paddingLeft:"16px",marginTop:"2px",marginBottom:"10px"},onPlaceSelected:this.onPlaceSelected,types:["(regions)"],componentRestrictions:{country:"de"}}),c.a.createElement("div",{className:"content"},c.a.createElement("h6",null,"Patient"),c.a.createElement("div",null,c.a.createElement(_.a,{"aria-label":"collapsible table"},c.a.createElement(j.a,null,this.state.data.length>0&&this.state.data.map((function(t,a){return c.a.createElement(T,{ref:e.Row,key:a,row:t,OnRowclick:e.handleClick})})))))))),a&&a.length>0&&c.a.createElement(k,{center:{lat:51.2235516,lng:6.6673354},height:"90vh",zoom:12,ref:this.mapPage,patients:a,selectedPatient:n}))}}]),a}(o.Component);t.default=B}}]);
//# sourceMappingURL=65.acd573fd.chunk.js.map