(this.webpackJsonphulk=this.webpackJsonphulk||[]).push([[64],{2540:function(e,t,a){"use strict";a.r(t);var n=a(85),i=a.n(n),r=a(124),o=a(28),s=a(194),l=a(15),c=a(16),p=a(421),m=a(18),d=a(17),u=a(0),g=a.n(u),f=(a(1588),a(236)),h=a(11),y=a(1527),v=a(1528),k=a(61),b=a(115),E=a(228),C=a(1529),O=a(1533),w=a(2248),S=a.n(w),P=a(2247),_=a.n(P),j=a(224),N=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).handleClick=function(e,t,a){console.log("event",e),t.id&&n.props.OnSelectRow({id:t.id,index:a})},n.state={open:!1},n}return Object(c.a)(a,[{key:"componentWillMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.props,a=t.row,n=t.index,i=t.open;return console.log("open",this.props.open),g.a.createElement(g.a.Fragment,null,g.a.createElement(O.a,{onClick:function(t){return e.handleClick(t,a,n)}},g.a.createElement(C.a,{align:"left",style:{width:"40%"}},a.firstName+" "+a.lastName),g.a.createElement(C.a,{align:"left",style:{width:"40%"}},a.phone1),g.a.createElement(C.a,{align:"right",style:{width:"20%"}},g.a.createElement(E.a,{"aria-label":"expand row",size:"small"},i?g.a.createElement(_.a,null):g.a.createElement(S.a,null)))),i?g.a.createElement(O.a,null,g.a.createElement(C.a,{style:{paddingBottom:5,paddingTop:5,width:"100%",height:"auto"},colSpan:6},g.a.createElement(j.a,{in:i,timeout:"auto",unmountOnExit:!0},g.a.createElement(k.a,{margin:1},g.a.createElement(b.a,{gutterBottom:!0,component:"div"},a.streetNr),g.a.createElement(b.a,{gutterBottom:!0,component:"div"},a.zipCode," ",a.city))))):"")}}]),a}(g.a.Component),x=a(1917),A={icon:"http://maps.google.com/mapfiles/ms/icons/pink-dot.png",scaledSize:100},I={icon:"http://maps.google.com/mapfiles/ms/icons/blue-dot.png",scaledSize:100},z=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).viewInfo=function(e){n.setState({open:!n.state.open})},n.closeInfo=function(e){n.setState({open:!1})},n.state={selectedPatient:"",open:!1},n}return Object(c.a)(a,[{key:"render",value:function(){var e=this.props,t=e.patient,a=e.position,n=e.key;return console.log("props ",this.state),g.a.createElement(g.a.Fragment,null,(1==this.state.open||this.props.open)&&g.a.createElement(x.InfoWindow,{position:{lat:t.lat,lng:t.lng}},g.a.createElement("div",null,g.a.createElement("span",{style:{padding:0,margin:0}},t.name," ",t.streetNr," ",t.zipCode," ",t.city))),t.id?g.a.createElement(x.Marker,{options:this.props.open?A:I,key:n,name:"Dolores park",position:a,onClick:this.viewInfo}):g.a.createElement(x.Marker,{key:n,name:"Dolores park",position:a,onClick:this.viewInfo}))}}]),a}(u.Component),M=a(2334),D=a.n(M),R=a(2335),B=a.n(R);D.a.setLanguage("de"),D.a.setRegion("de"),D.a.setApiKey("AIzaSyDMrIaIY6QY_kiOz0VSZkN36HBd4cnfkH8"),D.a.enableDebug();var T=[{featureType:"poi.medical",stylers:[{visibility:"off"}]},{featureType:"poi.school",stylers:[{visibility:"off"}]},{featureType:"poi.sports_complex",stylers:[{visibility:"off"}]},{featureType:"road.arterial",stylers:[{visibility:"off"}]},{featureType:"transit.station.airport",stylers:[{visibility:"off"}]},{featureType:"transit.station.rail",stylers:[{visibility:"off"}]}],L=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).onPlaceSelected=function(e){var t=e.formatted_address,a=e.address_components,i=n.getCity(a),r=n.getArea(a),o=n.getState(a),s=e.geometry.location.lat(),l=e.geometry.location.lng();n.setState({address:t||"",area:r||"",city:i||"",state:o||"",markerPosition:{lat:s,lng:l},mapPosition:{lat:s,lng:l}})},n.handleClick=function(e){if(n.state.patientAddress.length){var t=n.state.patientAddress.find((function(t){return t.id==e.id})),a=Object(s.a)(n.state.isOpen);a[e.index]=!a[e.index],n.setState({selectedPatient:e.id,mapPosition:{lat:t.lat,lng:t.lng},isOpen:a})}},n.getCity=function(e){for(var t=0;t<e.length;t++)if(e[t].types[0]&&"administrative_area_level_2"===e[t].types[0])return e[t].long_name},n.getArea=function(e){for(var t=0;t<e.length;t++)if(e[t].types[0])for(var a=0;a<e[t].types.length;a++)if("sublocality_level_1"===e[t].types[a]||"locality"===e[t].types[a])return e[t].long_name},n.getState=function(e){for(var t=0;t<e.length;t++)for(var a=0;a<e.length;a++)if(e[a].types[0]&&"administrative_area_level_1"===e[a].types[0])return e[a].long_name},n.onChange=function(e){n.setState(Object(o.a)({},e.target.name,e.target.value))},n.onInfoWindowClose=function(e){},n.onMarkerDragEnd=function(e){var t=e.latLng.lat(),a=e.latLng.lng();D.a.fromLatLng(t,a).then((function(e){var i=e.results[0].formatted_address,r=e.results[0].address_components,o=r.length?n.getCity(r):"",s=r.length?n.getArea(r):"",l=r.length?n.getState(r):"";n.setState({address:i||"",area:s||"",city:o||"",state:l||"",markerPosition:{lat:t,lng:a},mapPosition:{lat:t,lng:a}})}),(function(e){console.error(e)}))},n.state={data:[],openData:{},address:"",city:"",area:"",test:"",state:"",mapPosition:{lat:51.2235516,lng:6.6673354},markerPosition:{lat:51.2235516,lng:6.6673354},patients:[],patientAddress:[],selectedPatient:"",isOpen:[]},n.CustomMarker=g.a.createRef(),n.Row=g.a.createRef(),n.handleClick=n.handleClick.bind(Object(p.a)(n)),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this,a=JSON.parse(localStorage.getItem("user"));this.instance_id=a.instance_id,console.log("res",this.instance_id),f.a.getPatients({instance_id:this.instance_id,pagination:1}).then((function(a){var n=a;n=n.sort(t.compareAB),console.log("res",n),e.setState({data:n}),e.InitializePatient(n)}))}},{key:"compareAB",value:function(e,t){var a=e.firstName+" "+e.lastName,n=t.firstName+" "+t.lastName,i=a.toUpperCase(),r=n.toUpperCase(),o=0;return i>r?o=1:i<r&&(o=-1),o}},{key:"comparepatientAddress",value:function(e,t){var a=e.name,n=t.name,i=a.toUpperCase(),r=n.toUpperCase(),o=0;return i>r?o=1:i<r&&(o=-1),console.log("a , b",a,n,o),o}},{key:"InitializePatient",value:function(){var e=Object(r.a)(i.a.mark((function e(t){var a,n,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=this,n=[],o=[],t.map(function(){var e=Object(r.a)(i.a.mark((function e(r,s){var l,c,p,m;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.streetNr){e.next=6;break}return e.next=3,D.a.fromAddress(r.streetNr+", "+r.zipCode+" "+r.city);case 3:l=e.sent,c=l.results[0].geometry.location,p=c.lat,m=c.lng,p&&m&&(n.push({id:r.id,lat:p,lng:m,name:r.firstName+" "+r.lastName,streetNr:r.streetNr,zipCode:r.zipCode,city:r.city}),o.push(!1),t.length-2<s&&a.setState({patientAddress:n,isOpen:o}));case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,a=t.data,n=(t.selectedPatient,t.patientAddress),i=t.isOpen;console.log("data",n),n=n.sort(this.comparepatientAddress),console.log("data",a,n);var r=Object(x.withScriptjs)(Object(x.withGoogleMap)((function(t){return g.a.createElement(g.a.Fragment,null,g.a.createElement(x.GoogleMap,{defaultZoom:11,defaultCenter:{lat:e.state.mapPosition.lat,lng:e.state.mapPosition.lng},defaultOptions:{styles:T}},n.length>0&&n.map((function(t,a){return g.a.createElement(z,{ref:e.CustomMarker,key:a,open:i[a],patient:t,name:"Dolores park",position:{lat:t.lat,lng:t.lng}})})),g.a.createElement(z,{ref:e.CustomMarker,patient:{id:0,lat:e.state.markerPosition.lat,lng:e.state.markerPosition.lng,streetNr:e.state.address},position:{lat:e.state.markerPosition.lat,lng:e.state.markerPosition.lng}}),g.a.createElement(B.a,{style:{width:"100%",height:"40px",paddingLeft:"16px",marginTop:"10px",marginBottom:"10px",position:"absolute",top:"13vh",zIndex:500},onPlaceSelected:e.onPlaceSelected,types:["address"],componentRestrictions:{country:"de"}})))})));return g.a.createElement("div",{className:"tables-wrapper search-table-wrap"},g.a.createElement("div",{className:"patientsContainer"},g.a.createElement(h.c,null,g.a.createElement("div",{className:"content"},g.a.createElement("div",null,g.a.createElement(y.a,{"aria-label":"collapsible table "},g.a.createElement(v.a,null,this.state.data.length>0&&this.state.data.map((function(t,a){return g.a.createElement(N,{ref:e.Row,key:a,open:i[a],row:t,index:a,OnSelectRow:e.handleClick})})))))))),g.a.createElement(r,{googleMapURL:"https://maps.googleapis.com/maps/api/js?key=AIzaSyDMrIaIY6QY_kiOz0VSZkN36HBd4cnfkH8&libraries=places",loadingElement:g.a.createElement("div",{style:{height:"100%"}}),containerElement:g.a.createElement("div",{style:{height:"90vh",position:"relative"}}),mapElement:g.a.createElement("div",{style:{height:"100%"}})}))}}]),a}(u.Component);t.default=L}}]);
//# sourceMappingURL=64.d3d28d18.chunk.js.map