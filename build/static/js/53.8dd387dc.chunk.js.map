{"version":3,"sources":["routes/Tables/PatientsTable/index.js"],"names":["insuranceList","pharmaciesList","family_doctorsList","resourcesList","servicesList","PatientsTable","props","state","columns","title","field","render","rowData","src","picture","defaultUrl","className","editComponent","type","onChange","e","target","files","selectedResources","JSON","parse","resources","options","selected","id","isEditResources","setState","onSelectedChanged","lookup","selectedServices","services","name","console","log","currentService","isEditServices","selectedservice","size","color","checked","serviceplan","isEditServiceplan","data","this","user","localStorage","getItem","instance_id","userService","showPatients","pagination","then","res","map","ele","push","label","value","family_doctors","doctorName","insurances","pharmacies","pharmacyName","prevState","patients","center","maxWidth","px","xs","lg","editable","onRowAdd","newData","Promise","resolve","setTimeout","stringify","formData","FormData","append","addPatients","onRowUpdate","oldData","editPatients","indexOf","onRowDelete","deletePatients","splice","Component"],"mappings":"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","file":"static/js/53.8dd387dc.chunk.js","sourcesContent":["/**\r\n * Search Table\r\n*/\r\nimport React, { Component } from 'react';\r\nimport MaterialTable from 'material-table';\r\nimport { Container, Box, Switch, FormControl, InputLabel, Select } from '@material-ui/core';\r\nimport MultiSelect from \"@khanacademy/react-multi-select\";\r\nimport { userService } from '../../../_services';\r\n//Components\r\nimport { SmallTitleBar } from 'components/GlobalComponents';\r\nimport IntlMessages from 'util/IntlMessages';\r\n\r\nlet insuranceList = {};\r\nlet pharmaciesList = {};\r\nlet family_doctorsList = {};\r\nlet resourcesList = [];\r\nlet servicesList = [];\r\n\r\nclass PatientsTable extends Component {\r\n   constructor(props) {\r\n      super(props)\r\n      this.state = {\r\n         columns: [\r\n            {\r\n               title: 'Picture', field: 'picture', render: rowData => <img src={rowData.picture ? rowData.picture : this.defaultUrl} className=\"logo-td bdr-rad-50\" />,\r\n               editComponent: props => {\r\n                  return (\r\n                     <input\r\n                        type='file'\r\n                        onChange={e => props.onChange(e.target.files[0])}\r\n                     />\r\n                  )\r\n\r\n               }\r\n            },\r\n            { title: 'Salutation', field: 'salutation' },\r\n            { title: 'First Name', field: 'firstName' },\r\n            { title: 'Last Name', field: 'lastName' },\r\n            { title: 'Street nr', field: 'streetNr' },\r\n            { title: 'zip code', field: 'zipCode' },\r\n            { title: 'City', field: 'city' },\r\n            { title: 'Birthday', field: 'birthday' },\r\n            { title: 'Phone 1', field: 'phone1' },\r\n            { title: 'Phone 2', field: 'phone2' },\r\n            { title: 'E-Mail', field: 'email' },\r\n\r\n            {\r\n               title: 'Resources', field: 'resources', render: props => {\r\n                  let selectedResources = JSON.parse(props.resources);\r\n                  if (!selectedResources) {\r\n                     selectedResources = [];\r\n                  }\r\n                  return (\r\n                     <MultiSelect\r\n                        options={resourcesList}\r\n                        selected={selectedResources}\r\n                     />\r\n                  )\r\n\r\n               },\r\n               editComponent: rowData => {\r\n                  if (rowData.rowData.id) {\r\n                     let selected = JSON.parse(rowData.rowData.resources);\r\n                     if (!selected) {\r\n                        selected = [];\r\n                     }\r\n                     if (this.state.isEditResources) {\r\n                        this.setState({ selected: selected, isEditResources: false })\r\n                     }\r\n                  }\r\n\r\n                  return (\r\n                     <MultiSelect\r\n\r\n                        options={resourcesList}\r\n                        selected={this.state.selected}\r\n                        onSelectedChanged={selected => this.setState({ selected })}\r\n\r\n                     />\r\n                  )\r\n\r\n               }\r\n\r\n            },\r\n\r\n            {\r\n               title: 'Insurance', field: 'insurance', lookup: insuranceList\r\n            },\r\n            {\r\n               title: 'Services', field: 'services', render: props => {\r\n                  let selectedServices = JSON.parse(props.services);\r\n                  if (!selectedServices) {\r\n                     selectedServices = [];\r\n                  }\r\n                  return (\r\n                     <MultiSelect\r\n                        name=\"services\"\r\n                        options={servicesList}\r\n                        selected={selectedServices}\r\n                     />\r\n                  )\r\n               },\r\n               editComponent: rowData => {\r\n                  console.log('rowData.rowData.id', rowData.rowData.id);\r\n                  if (rowData.rowData.id) {\r\n                     let currentService = JSON.parse(rowData.rowData.services);\r\n                     console.log('currentService', currentService);\r\n                     if (!currentService) {\r\n                        currentService = [];\r\n                     }\r\n                     if (this.state.isEditServices) {\r\n                        this.setState({ selectedservice: currentService, isEditServices: false })\r\n                     }\r\n                  }\r\n                  return (\r\n                     <MultiSelect\r\n                        options={servicesList}\r\n                        selected={this.state.selectedservice}\r\n                        onSelectedChanged={selectedservice => { console.log(\"selectedservice\", selectedservice); this.setState({ selectedservice }) }}\r\n                     />\r\n                  )\r\n\r\n               }\r\n            },\r\n            {\r\n               title: 'Family Doctor', field: 'familyDoctor', lookup: family_doctorsList\r\n            },\r\n            { title: 'Key number', field: 'keyNumber', type: 'numeric' },\r\n            { title: 'Floor', field: 'floor', type: 'numeric' },\r\n            {\r\n               title: 'Degree of care', field: 'degreeCare'\r\n            },\r\n            {\r\n               title: 'Pharmacy', field: 'pharmacy', lookup: pharmaciesList\r\n            },\r\n            { title: 'User group', field: 'userGroup' },\r\n            { title: 'Status', field: 'status' },\r\n            {\r\n\t\t\t\t\ttitle: 'Serviceplan', field: 'serviceplan', render: rowData => {\r\n\t\t\t\t\t\treturn (<Switch\r\n\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\tcolor=\"primary\"\r\n\t\t\t\t\t\t\tchecked={rowData.serviceplan ? true : false}\r\n\t\t\t\t\t\t/>)\r\n\r\n\t\t\t\t\t},\r\n\t\t\t\t\teditComponent: rowData => {\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tif (this.state.isEditServiceplan && rowData.rowData.id) {\r\n\t\t\t\t\t\t\tthis.setState({ serviceplan: rowData.rowData.serviceplan ? true : false, isEditServiceplan: false });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn (<Switch\r\n\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\tcolor=\"primary\"\r\n\t\t\t\t\t\t\tchecked={this.state.serviceplan}\r\n\t\t\t\t\t\t\tonChange={e => this.setState({ serviceplan: e.target.checked })}\r\n\t\t\t\t\t\t/>)\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n         ],\r\n         data: [],\r\n         selected: [],\r\n         selectedservice: [],\r\n         isEditServices: true,\r\n         isEditResources: true,\r\n         isEditServiceplan : true,\r\n         serviceplan : true\r\n\r\n      };\r\n\r\n\r\n   }\r\n\r\n\r\n   componentDidMount() {\r\n      this.defaultUrl = \"https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcSTbZrzTIuXAe01k5wgrhWGzPRPRliQygmBCA&usqp=CAU\";\r\n      let user = JSON.parse(localStorage.getItem('user_id'));\r\n      this.instance_id = user.instance_id;\r\n      console.log('res', this.instance_id);\r\n      userService.showPatients({ instance_id: this.instance_id, pagination: 1 }).then(res => {\r\n         resourcesList = [];\r\n         servicesList = [];\r\n         res.services.map(ele => {\r\n            servicesList.push({ label: ele.services, value: ele.services });\r\n         })\r\n         res.resources.map(ele => {\r\n            resourcesList.push({ label: ele.resources, value: ele.resources });\r\n         })\r\n\r\n         res.family_doctors.map(ele => {\r\n            family_doctorsList[ele.doctorName] = ele.doctorName;\r\n         })\r\n    \r\n         res.insurances.map(ele => {\r\n            insuranceList[ele.insurances] = ele.insurances;\r\n         })\r\n          \r\n         \r\n         res.pharmacies.map(ele => {\r\n            pharmaciesList[ele.pharmacyName] = ele.pharmacyName;\r\n         })\r\n         // console.log('this.insta' , this.insurances);  \r\n\r\n\r\n         this.setState(prevState => {\r\n            const data = res.patients;\r\n            return { ...prevState, data };\r\n         });\r\n\r\n      })\r\n\r\n   }\r\n\r\n   render() {\r\n\r\n      return (\r\n         <div className=\"tables-wrapper search-table-wrap\">\r\n            <SmallTitleBar\r\n               title={<IntlMessages id=\"sidebar.patients\" />}\r\n               center\r\n            />\r\n            <Container maxWidth=\"lg\">\r\n               <Box px={{ xs: '12px', lg: 0 }} className=\"page-space\">\r\n                  <MaterialTable\r\n                     title={<IntlMessages id=\"sidebar.patients\" />}\r\n                     columns={this.state.columns}\r\n                     data={this.state.data}\r\n\r\n                     editable={{\r\n                        onRowAdd: newData =>\r\n                           new Promise(resolve => {\r\n                              setTimeout(() => {\r\n                                 resolve();\r\n\r\n                                 newData.instance_id = this.instance_id;\r\n                                 newData.resources = JSON.stringify(this.state.selected);\r\n                                 newData.services = JSON.stringify(this.state.selectedservice);\r\n                                 const formData = new FormData()\r\n                                 formData.append('file', newData.picture);\r\n                                 newData.picture = '';\r\n                                 formData.append('data', JSON.stringify(newData));\r\n                                 userService.addPatients(formData).then(res => {\r\n                                    const selected = [];\r\n                                    const selectedservice = [];\r\n                                    this.setState(prevState => {\r\n                                       const data = [...prevState.data];\r\n                                       data.push(res);\r\n                                       return { ...prevState, data };\r\n                                    });\r\n                                    this.setState({ selected: selected, selectedservice: selectedservice, isEditServices: true, isEditResources: true , isEditServiceplan : true });\r\n                                 });\r\n\r\n                              }, 600);\r\n                           }),\r\n                        onRowUpdate: (newData, oldData) =>\r\n                           new Promise(resolve => {\r\n                              setTimeout(() => {\r\n                                 resolve();\r\n                                 const formData = new FormData()\r\n                                 if (typeof newData.picture == 'object') {\r\n                                    formData.append('file', newData.picture);\r\n                                    newData.picture = '';\r\n                                 }\r\n                                 newData.resources = JSON.stringify(this.state.selected);\r\n                                 newData.services = JSON.stringify(this.state.selectedservice);\r\n                                 formData.append('data', JSON.stringify(newData));\r\n\r\n                                 userService.editPatients(formData).then(res => {\r\n                                    if (oldData) {\r\n                                       this.setState(prevState => {\r\n                                          const data = [...prevState.data];\r\n                                          data[data.indexOf(oldData)] = res;\r\n                                          return { ...prevState, data };\r\n                                       });\r\n                                       const selected = [];\r\n                                       const selectedservice = [];\r\n                                       this.setState({ selected: selected, selectedservice: selectedservice, isEditServices: true, isEditResources: true ,isEditServiceplan : true });\r\n                                    }\r\n                                 })\r\n                              }, 600);\r\n                           }),\r\n                        onRowDelete: oldData =>\r\n                           new Promise(resolve => {\r\n                              setTimeout(() => {\r\n                                 resolve();\r\n                                 console.log(';oldData', oldData.id);\r\n                                 userService.deletePatients({ id: oldData.id }).then(res => {\r\n                                    console.log('res', res);\r\n                                    this.setState(prevState => {\r\n                                       const data = [...prevState.data];\r\n                                       data.splice(data.indexOf(oldData), 1);\r\n                                       return { ...prevState, data };\r\n                                    });\r\n                                 })\r\n                              }, 600);\r\n                           }),\r\n                     }}\r\n                  />\r\n               </Box>\r\n            </Container>\r\n         </div>\r\n      );\r\n   }\r\n}\r\nexport default PatientsTable;\r\n\r\n\r\n"],"sourceRoot":""}