(this.webpackJsonphulk=this.webpackJsonphulk||[]).push([[64],{2540:function(e,t,a){"use strict";a.r(t);var n=a(85),i=a.n(n),r=a(124),l=a(28),o=a(15),s=a(16),c=a(421),p=a(18),d=a(17),m=a(0),u=a.n(m),g=(a(1588),a(236)),f=a(11),h=a(1527),y=a(1528),v=a(61),k=a(115),E=a(228),b=a(1529),w=a(1533),O=a(2248),P=a.n(O),S=a(2247),C=a.n(S),_=a(224),j=function(e){Object(p.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleClick=function(e){e.id&&n.props.OnSelectRow(e.id)},n.state={open:!1},n}return Object(s.a)(a,[{key:"componentWillMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.props,a=t.row,n=t.selectedPatient;return console.log("open",this.props),u.a.createElement(u.a.Fragment,null,u.a.createElement(w.a,null,u.a.createElement(b.a,{align:"left",style:{width:"40%"}},a.firstName+" "+a.lastName),u.a.createElement(b.a,{align:"left",style:{width:"40%"}},a.phone1),u.a.createElement(b.a,{align:"right",style:{width:"20%"}},u.a.createElement(E.a,{"aria-label":"expand row",size:"small",onClick:function(){return e.handleClick(a)}},a.id==n?u.a.createElement(C.a,null):u.a.createElement(P.a,null)))),a.id==n?u.a.createElement(w.a,null,u.a.createElement(b.a,{style:{paddingBottom:5,paddingTop:5,width:"100%",height:"auto"},colSpan:6},u.a.createElement(_.a,{in:a.id==n,timeout:"auto",unmountOnExit:!0},u.a.createElement(v.a,{margin:1},u.a.createElement(k.a,{gutterBottom:!0,component:"div"},a.streetNr),u.a.createElement(k.a,{gutterBottom:!0,component:"div"},a.zipCode," ",a.city))))):"")}}]),a}(u.a.Component),N=a(1917),M={icon:"http://maps.google.com/mapfiles/ms/icons/pink-dot.png",scaledSize:100},I={icon:"http://maps.google.com/mapfiles/ms/icons/blue-dot.png",scaledSize:100},z=function(e){Object(p.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).viewInfo=function(e){console.log("event"),n.setState({open:!n.state.open})},n.closeInfo=function(e){console.log("event"),n.setState({open:!1})},n.state={selectedPatient:"",open:!1},n}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.patient,a=e.position,n=e.key;return u.a.createElement(u.a.Fragment,null,1==this.state.open&&u.a.createElement(N.InfoWindow,{position:{lat:t.lat+.002,lng:t.lng}},u.a.createElement("div",null,u.a.createElement("span",{style:{padding:0,margin:0}},t.name," ",t.streetNr," ",t.zipCode," ",t.city))),t.id?u.a.createElement(N.Marker,{options:t.id==this.state.selectedPatient?M:I,key:n,name:"Dolores park",position:a,onMouseOver:this.viewInfo}):u.a.createElement(N.Marker,{key:n,name:"Dolores park",position:a,onMouseOver:this.viewInfo}))}}]),a}(m.Component),A=a(2334),x=a.n(A),D=a(2335),R=a.n(D);x.a.setLanguage("de"),x.a.setRegion("de"),x.a.setApiKey("AIzaSyDMrIaIY6QY_kiOz0VSZkN36HBd4cnfkH8"),x.a.enableDebug();var T=[{featureType:"poi.medical",stylers:[{visibility:"off"}]},{featureType:"poi.school",stylers:[{visibility:"off"}]},{featureType:"poi.sports_complex",stylers:[{visibility:"off"}]},{featureType:"road.arterial",stylers:[{visibility:"off"}]},{featureType:"transit.station.airport",stylers:[{visibility:"off"}]},{featureType:"transit.station.rail",stylers:[{visibility:"off"}]}],L=function(e){Object(p.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).onPlaceSelected=function(e){console.log("plc",e);var t=e.formatted_address,a=e.address_components,i=n.getCity(a),r=n.getArea(a),l=n.getState(a),o=e.geometry.location.lat(),s=e.geometry.location.lng();n.setState({address:t||"",area:r||"",city:i||"",state:l||"",markerPosition:{lat:o,lng:s},mapPosition:{lat:o,lng:s}})},n.handleClick=function(e){if(n.CustomMarker.current.setState({selectedPatient:e}),n.state.patientAddress.length){var t=n.state.patientAddress.find((function(t){return t.id==e}));n.setState({selectedPatient:e,mapPosition:{lat:t.lat,lng:t.lng}})}},n.getCity=function(e){for(var t=0;t<e.length;t++)if(e[t].types[0]&&"administrative_area_level_2"===e[t].types[0])return e[t].long_name},n.getArea=function(e){for(var t=0;t<e.length;t++)if(e[t].types[0])for(var a=0;a<e[t].types.length;a++)if("sublocality_level_1"===e[t].types[a]||"locality"===e[t].types[a])return e[t].long_name},n.getState=function(e){for(var t=0;t<e.length;t++)for(var a=0;a<e.length;a++)if(e[a].types[0]&&"administrative_area_level_1"===e[a].types[0])return e[a].long_name},n.onChange=function(e){n.setState(Object(l.a)({},e.target.name,e.target.value))},n.onInfoWindowClose=function(e){},n.onMarkerDragEnd=function(e){var t=e.latLng.lat(),a=e.latLng.lng();x.a.fromLatLng(t,a).then((function(e){var i=e.results[0].formatted_address,r=e.results[0].address_components,l=r.length?n.getCity(r):"",o=r.length?n.getArea(r):"",s=r.length?n.getState(r):"";n.setState({address:i||"",area:o||"",city:l||"",state:s||"",markerPosition:{lat:t,lng:a},mapPosition:{lat:t,lng:a}})}),(function(e){console.error(e)}))},n.state={data:[],openData:{},address:"",city:"",area:"",test:"",state:"",mapPosition:{lat:51.2235516,lng:6.6673354},markerPosition:{lat:51.2235516,lng:6.6673354},patients:[],patientAddress:[],selectedPatient:""},n.CustomMarker=u.a.createRef(),n.Row=u.a.createRef(),n.handleClick=n.handleClick.bind(Object(c.a)(n)),n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=JSON.parse(localStorage.getItem("user"));this.instance_id=t.instance_id,console.log("res",this.instance_id),g.a.getPatients({instance_id:this.instance_id,pagination:1}).then((function(t){var a=t;e.setState({data:a}),e.InitializePatient(a)}))}},{key:"InitializePatient",value:function(){var e=Object(r.a)(i.a.mark((function e(t){var a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=this,n=[],t.map(function(){var e=Object(r.a)(i.a.mark((function e(r,l){var o,s,c,p;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.streetNr){e.next=6;break}return e.next=3,x.a.fromAddress(r.streetNr);case 3:o=e.sent,s=o.results[0].geometry.location,c=s.lat,p=s.lng,c&&p&&(n.push({id:r.id,lat:c,lng:p,name:r.firstName+" "+r.lastName,streetNr:r.streetNr,zipCode:r.zipCode,city:r.city}),t.length-2<l&&a.setState({patientAddress:n}));case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,a=(t.data,t.selectedPatient),n=t.patientAddress;console.log("this.state",this.state);var i=Object(N.withScriptjs)(Object(N.withGoogleMap)((function(t){return u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{className:"patientsContainer"},u.a.createElement(f.c,null,u.a.createElement("div",{className:"content"},u.a.createElement("div",null,u.a.createElement(h.a,{"aria-label":"collapsible table "},u.a.createElement(y.a,null,e.state.data.length>0&&e.state.data.map((function(t,n){return u.a.createElement(j,{ref:e.Row,key:n,row:t,OnSelectRow:e.handleClick,selectedPatient:a})})))))))),u.a.createElement(N.GoogleMap,{defaultZoom:11,defaultCenter:{lat:e.state.mapPosition.lat,lng:e.state.mapPosition.lng},defaultOptions:{styles:T}},n.length>0&&n.map((function(t,a){return u.a.createElement(z,{ref:e.CustomMarker,key:a,patient:t,name:"Dolores park",position:{lat:t.lat,lng:t.lng}})})),u.a.createElement(z,{ref:e.CustomMarker,patient:{id:0,lat:e.state.markerPosition.lat,lng:e.state.markerPosition.lng,streetNr:e.state.address},position:{lat:e.state.markerPosition.lat,lng:e.state.markerPosition.lng}}),u.a.createElement(R.a,{style:{width:"100%",height:"40px",paddingLeft:"16px",marginTop:"2px",marginBottom:"10px",position:"absolute",top:"10vh"},onPlaceSelected:e.onPlaceSelected,types:["address"],componentRestrictions:{country:"de"}})))})));return u.a.createElement("div",{className:"tables-wrapper search-table-wrap"},u.a.createElement(i,{googleMapURL:"https://maps.googleapis.com/maps/api/js?key=AIzaSyDMrIaIY6QY_kiOz0VSZkN36HBd4cnfkH8&libraries=places",loadingElement:u.a.createElement("div",{style:{height:"100%"}}),containerElement:u.a.createElement("div",{style:{height:"90vh",position:"relative"}}),mapElement:u.a.createElement("div",{style:{height:"100%"}})}))}}]),a}(m.Component);t.default=L}}]);
//# sourceMappingURL=64.76bb1b99.chunk.js.map